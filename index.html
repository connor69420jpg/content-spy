<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Content Spy</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#08080c;--bg2:#0c0c12;--bg3:#111118;--bg4:#16161f;--bdr:rgba(255,255,255,.04);--bdr2:rgba(255,255,255,.07);--t1:#fff;--t2:rgba(255,255,255,.55);--t3:rgba(255,255,255,.25);--t4:rgba(255,255,255,.12);--ig:#E1306C;--tt:#25F4EE;--green:#00E676;--amber:#FFD740;--r:10px;--r2:14px;--r3:20px;--mono:'DM Sans',sans-serif;--sans:'Plus Jakarta Sans',sans-serif;--ease:cubic-bezier(.4,0,.2,1)}
*{box-sizing:border-box;margin:0;padding:0}body{background:var(--bg);color:var(--t1);font-family:var(--sans);-webkit-font-smoothing:antialiased;overflow:hidden;height:100vh}::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(255,255,255,.05);border-radius:4px}input,select,button{font-family:inherit;outline:none;border:none}a{color:inherit;text-decoration:none}.app{display:flex;height:100vh}
.sidebar{width:240px;flex-shrink:0;background:var(--bg2);display:flex;flex-direction:column;position:relative;z-index:2}.sidebar::after{content:"";position:absolute;top:0;right:0;bottom:0;width:1px;background:linear-gradient(to bottom,transparent,var(--bdr2) 20%,var(--bdr2) 80%,transparent)}.sb-hd{padding:20px 16px 12px}.sb-logo{margin-bottom:4px}.sb-logo h1{font-size:22px;font-weight:800;letter-spacing:-.5px;color:#fff;line-height:1.1}.sb-logo .sub{font-size:11px;font-weight:500;color:var(--t2);margin-top:4px;letter-spacing:.1px}.sb-status{display:flex;align-items:center;gap:6px;margin-top:8px}.sb-dot{width:5px;height:5px;border-radius:50%;animation:pulse 2.5s ease infinite}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}.sb-status span{font-size:9px;color:var(--t3);font-family:var(--mono);letter-spacing:.5px}.sb-search{padding:0 12px 8px}.sb-search input{width:100%;padding:8px 12px;background:rgba(255,255,255,.02);border:1px solid var(--bdr);border-radius:var(--r);color:var(--t1);font-size:12px;transition:all .2s var(--ease)}.sb-search input::placeholder{color:var(--t4)}.sb-search input:focus{border-color:var(--bdr2);background:rgba(255,255,255,.03);box-shadow:0 0 0 3px rgba(255,255,255,.02)}.sb-list{flex:1;overflow-y:auto;padding:0 8px}.sb-item{display:flex;align-items:center;gap:8px;padding:6px 8px;border-radius:var(--r);cursor:pointer;transition:all .15s var(--ease);margin-bottom:1px;position:relative}.sb-item:hover{background:rgba(255,255,255,.025)}.sb-item.on{background:rgba(255,255,255,.04)}.sb-item.on::before{content:"";position:absolute;left:0;top:25%;bottom:25%;width:2px;border-radius:1px}.sb-r{width:18px;font-size:10px;color:var(--t4);font-family:var(--mono);text-align:right;flex-shrink:0;font-weight:500}.sb-item.on .sb-r{color:var(--t3)}.sb-av{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;flex-shrink:0;letter-spacing:-.5px;transition:transform .15s var(--ease)}.sb-item:hover .sb-av{transform:scale(1.05)}.sb-n{font-size:12px;font-weight:400;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--t2);transition:color .15s var(--ease)}.sb-item.on .sb-n{font-weight:600;color:var(--t1)}.sb-item:hover .sb-n{color:var(--t1)}.sb-more{padding:8px;text-align:center;font-size:9px;color:var(--t4);cursor:pointer;font-family:var(--mono);letter-spacing:.5px;transition:color .15s var(--ease)}.sb-more:hover{color:var(--t2)}.sb-ft{padding:10px 12px;position:relative}.sb-ft::before{content:"";position:absolute;top:0;left:12px;right:12px;height:1px;background:linear-gradient(to right,transparent,var(--bdr2),transparent)}.sb-ft button{width:100%;padding:8px;background:rgba(255,255,255,.02);border:1px solid var(--bdr);border-radius:var(--r);color:var(--t2);font-size:11px;cursor:pointer;font-weight:500;transition:all .15s var(--ease);letter-spacing:.3px}.sb-ft button:hover{background:rgba(255,255,255,.04);border-color:var(--bdr2);color:var(--t1)}
.main{flex:1;display:flex;flex-direction:column;overflow:hidden}.top{padding:14px 20px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;position:relative}.top::after{content:"";position:absolute;bottom:0;left:20px;right:20px;height:1px;background:linear-gradient(to right,transparent,var(--bdr2),transparent)}.top-l{display:flex;align-items:center;gap:10px}.top-av{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;letter-spacing:-.5px;position:relative;overflow:hidden}.top-av::after{content:"";position:absolute;inset:0;background:linear-gradient(135deg,transparent 40%,rgba(255,255,255,.15))}.top-name{font-size:16px;font-weight:700;letter-spacing:-.3px}.top-sub{font-size:10px;color:var(--t3);font-family:var(--mono);margin-top:1px;letter-spacing:.3px}.top-r{display:flex;gap:6px;align-items:center;flex-wrap:wrap}.chip{background:rgba(255,255,255,.025);border:1px solid var(--bdr);border-radius:var(--r);padding:6px 12px;color:var(--t2);font-size:10px;cursor:pointer;font-family:var(--mono);font-weight:500;transition:all .15s var(--ease);letter-spacing:.3px}.chip:hover{background:rgba(255,255,255,.05);border-color:var(--bdr2);color:var(--t1)}.chip:disabled{opacity:.25;cursor:default;pointer-events:none}.chip-grp{display:flex;background:rgba(255,255,255,.02);border-radius:var(--r);border:1px solid var(--bdr);overflow:hidden}.chip-grp button{padding:6px 10px;font-size:10px;font-weight:500;border:none;cursor:pointer;font-family:var(--mono);background:transparent;color:var(--t4);transition:all .15s var(--ease);letter-spacing:.3px;position:relative}.chip-grp button:hover{color:var(--t2)}.chip-grp button.on{color:var(--t1)}.chip-grp button.on::after{content:"";position:absolute;bottom:0;left:20%;right:20%;height:1.5px;border-radius:1px}.sel{padding:6px 10px;font-size:10px;background:rgba(255,255,255,.025);border:1px solid var(--bdr);border-radius:var(--r);color:var(--t2);font-family:var(--mono);font-weight:500;cursor:pointer}select option{background:var(--bg3);color:var(--t1)}
.cnt{flex:1;overflow-y:auto;padding:18px 20px}.tabs{display:flex;gap:6px;margin-bottom:16px}.tab{padding:8px 16px;border-radius:var(--r);cursor:pointer;font-size:11px;font-weight:500;background:rgba(255,255,255,.015);display:flex;align-items:center;gap:6px;transition:all .15s var(--ease);color:var(--t3);border:1px solid transparent}.tab:hover{background:rgba(255,255,255,.03);color:var(--t2)}.tab.on{color:var(--t1);background:rgba(255,255,255,.04);border-color:var(--bdr2)}.tab .dot{width:5px;height:5px;border-radius:50%}.tab .num{font-size:9px;color:var(--t4);font-family:var(--mono);padding:1px 5px;background:rgba(255,255,255,.03);border-radius:4px}.strip{display:flex;gap:20px;margin-bottom:18px;padding:12px 0}.strip-item{display:flex;flex-direction:column;gap:2px}.strip .v{font-size:20px;font-weight:700;letter-spacing:-.5px}.strip .l{font-size:9px;color:var(--t4);font-family:var(--mono);text-transform:uppercase;letter-spacing:1px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:12px;margin-bottom:16px}.card{background:var(--bg3);border:1px solid var(--bdr);border-radius:var(--r2);overflow:hidden;cursor:pointer;transition:all .25s var(--ease)}.card:hover{border-color:var(--bdr2);transform:translateY(-2px);box-shadow:0 12px 40px rgba(0,0,0,.3)}.card-img{width:100%;aspect-ratio:1;background:var(--bg4);position:relative;overflow:hidden}.card-img img{width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .4s var(--ease),transform .4s var(--ease)}.card-img img.loaded{opacity:1}.card:hover .card-img img.loaded{transform:scale(1.03)}.card-img video{width:100%;height:100%;object-fit:cover;opacity:0;position:absolute;inset:0;transition:opacity .35s var(--ease)}.card:hover .card-img video{opacity:1}.card-ph{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;padding:20px;text-align:center}.card-ph .e{font-size:32px;margin-bottom:8px;filter:saturate(.7)}.card-ph .c{font-size:11px;color:var(--t3);line-height:1.6;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.badges{position:absolute;top:8px;left:8px;display:flex;gap:4px}.badges span{font-size:8px;padding:3px 7px;border-radius:6px;font-family:var(--mono);font-weight:600;backdrop-filter:blur(12px);letter-spacing:.5px}.b-off{background:rgba(255,255,255,.1);color:#fff;border:1px solid rgba(255,255,255,.12)}.b-fan{background:rgba(0,0,0,.5);color:var(--t2);border:1px solid rgba(255,255,255,.06)}.b-ig{background:rgba(225,48,108,.15);color:var(--ig);border:1px solid rgba(225,48,108,.2)}.b-tt{background:rgba(37,244,238,.08);color:var(--tt);border:1px solid rgba(37,244,238,.15)}.card-type{position:absolute;top:8px;right:8px;font-size:8px;padding:3px 7px;border-radius:6px;background:rgba(0,0,0,.5);color:var(--t2);font-family:var(--mono);backdrop-filter:blur(12px)}.card-eng{position:absolute;bottom:8px;right:8px;font-size:10px;font-weight:600;padding:4px 9px;border-radius:7px;font-family:var(--mono);backdrop-filter:blur(12px)}.play{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:44px;height:44px;border-radius:50%;background:rgba(0,0,0,.4);backdrop-filter:blur(8px);border:1.5px solid rgba(255,255,255,.15);display:flex;align-items:center;justify-content:center;transition:all .25s var(--ease)}.play::after{content:"";border-style:solid;border-width:7px 0 7px 12px;border-color:transparent transparent transparent rgba(255,255,255,.9);margin-left:2px}.card:hover .play{opacity:0;transform:translate(-50%,-50%) scale(.8)}.card-bd{padding:12px 14px}.card-hd{display:flex;align-items:center;gap:6px;margin-bottom:5px}.card-hn{font-size:12px;font-weight:600;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.card-dt{font-size:9px;color:var(--t4);font-family:var(--mono)}.card-cp{font-size:11px;color:var(--t3);line-height:1.5;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;margin-bottom:10px}.card-st{display:flex;gap:10px}.card-st span{font-size:10px;font-weight:500;font-family:var(--mono);color:var(--t3);transition:color .15s}.card:hover .card-st span{color:var(--t2)}
.ov{position:fixed;inset:0;z-index:100;background:rgba(0,0,0,.75);backdrop-filter:blur(20px);display:flex;align-items:center;justify-content:center;animation:fadeIn .2s var(--ease)}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.md{background:var(--bg3);border:1px solid var(--bdr2);border-radius:var(--r3);width:92%;max-width:520px;max-height:85vh;overflow-y:auto;animation:slideUp .25s var(--ease);box-shadow:0 24px 80px rgba(0,0,0,.5)}@keyframes slideUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}.md-media{width:100%;background:var(--bg);position:relative;border-radius:var(--r3) var(--r3) 0 0;overflow:hidden;min-height:180px}.md-media video{width:100%;display:block;max-height:480px;object-fit:contain;background:#000}.md-media img{width:100%;display:block;object-fit:cover;max-height:480px}.md-x{position:absolute;top:12px;right:12px;width:32px;height:32px;border-radius:50%;background:rgba(0,0,0,.4);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.1);color:#fff;font-size:13px;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:5;transition:all .15s var(--ease)}.md-x:hover{background:rgba(255,255,255,.1)}.md-mute{position:absolute;top:12px;left:12px;padding:5px 10px;border-radius:7px;background:rgba(0,0,0,.4);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.1);color:#fff;font-size:9px;cursor:pointer;font-family:var(--mono);z-index:5}.md-body{padding:20px 22px}.md-handle{font-size:15px;font-weight:700}.md-tags{display:flex;gap:5px;align-items:center;flex-wrap:wrap;margin-bottom:10px}.md-tag{font-size:8px;padding:3px 7px;border-radius:5px;font-family:var(--mono);font-weight:500}.md-cap{font-size:13px;color:var(--t2);line-height:1.7;margin-bottom:18px}.md-stats{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:16px}.md-stat{background:rgba(255,255,255,.02);border:1px solid var(--bdr);border-radius:var(--r);padding:12px;text-align:center;transition:all .15s}.md-stat:hover{background:rgba(255,255,255,.04)}.md-stat .sv{font-size:20px;font-weight:700;letter-spacing:-.5px}.md-stat .sl{font-size:8px;color:var(--t4);text-transform:uppercase;letter-spacing:1px;font-family:var(--mono);margin-top:3px}.md-link{display:inline-flex;align-items:center;gap:6px;padding:10px 18px;background:rgba(255,255,255,.03);border:1px solid var(--bdr);border-radius:var(--r);color:var(--t2);font-size:11px;font-family:var(--mono);transition:all .15s}.md-link:hover{background:rgba(255,255,255,.06);color:var(--t1);transform:translateX(2px)}
.stg{background:var(--bg3);border:1px solid var(--bdr2);border-radius:var(--r3);padding:24px;width:92%;max-width:440px;max-height:80vh;overflow-y:auto;animation:slideUp .25s var(--ease);box-shadow:0 24px 80px rgba(0,0,0,.5)}.stg h2{font-size:17px;font-weight:700;margin-bottom:18px}.stg-x{float:right;background:none;border:none;color:var(--t3);font-size:16px;cursor:pointer}.stg-x:hover{color:var(--t1)}.stg-s{background:rgba(255,255,255,.015);border-radius:var(--r);padding:14px;margin-bottom:10px;border:1px solid var(--bdr);transition:border-color .15s}.stg-s:hover{border-color:var(--bdr2)}.stg-t{font-size:8px;color:var(--t3);text-transform:uppercase;letter-spacing:1.5px;margin-bottom:8px;font-family:var(--mono);font-weight:600}.stg-in{width:100%;padding:9px 12px;background:rgba(255,255,255,.025);border:1px solid var(--bdr);border-radius:8px;color:var(--t1);font-size:11px;font-family:var(--mono);margin-top:4px;transition:all .15s}.stg-in::placeholder{color:var(--t4)}.stg-in:focus{border-color:var(--bdr2);box-shadow:0 0 0 3px rgba(255,255,255,.02)}.stg-btn{padding:8px 14px;border:none;border-radius:8px;color:#fff;font-size:10px;font-weight:600;cursor:pointer;margin-right:4px;margin-top:6px;transition:all .15s}.stg-btn:hover{filter:brightness(1.1);transform:translateY(-1px)}.stg-steps{font-size:10px;color:var(--t2);line-height:2.2;font-family:var(--mono)}.stg-steps b{color:var(--tt)}
.toast{position:fixed;bottom:20px;right:20px;z-index:200;background:var(--bg3);border:1px solid var(--bdr2);border-radius:var(--r);padding:12px 16px;font-size:11px;color:var(--t2);font-family:var(--mono);animation:toastIn .3s var(--ease);max-width:380px;backdrop-filter:blur(20px);box-shadow:0 8px 32px rgba(0,0,0,.4)}@keyframes toastIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.ft{text-align:center;padding:20px 0;font-size:9px;color:var(--t4);font-family:var(--mono)}.empty{text-align:center;padding:60px 20px;font-size:13px;color:var(--t3);line-height:1.8}@keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}.busy-chip{background:linear-gradient(90deg,transparent 30%,rgba(255,255,255,.03) 50%,transparent 70%)!important;background-size:200% 100%;animation:shimmer 1.5s infinite}
.skel{background:var(--bg3);border:1px solid var(--bdr);border-radius:var(--r2);overflow:hidden}.skel-img{width:100%;aspect-ratio:1;background:linear-gradient(90deg,var(--bg4) 25%,rgba(255,255,255,.02) 50%,var(--bg4) 75%);background-size:200% 100%;animation:shimmer 1.8s ease infinite}.skel-bd{padding:12px 14px}.skel-ln{height:10px;border-radius:4px;background:linear-gradient(90deg,var(--bg4) 25%,rgba(255,255,255,.02) 50%,var(--bg4) 75%);background-size:200% 100%;animation:shimmer 1.8s ease infinite;margin-bottom:8px}.skel-ln.w60{width:60%}.skel-ln.w80{width:80%}.skel-ln.w40{width:40%}.skel-row{display:flex;gap:10px;margin-top:6px}.skel-row .skel-ln{width:50px;height:8px;margin:0}
.cache-tag{font-size:9px;color:var(--t4);font-family:var(--mono);display:flex;align-items:center;gap:4px}.cache-tag .fresh{color:var(--green)}.cache-tag .stale{color:var(--amber)}
</style>
</head>
<body>
<div class="app" id="app"></div>
<script>
const A=[{r:1,n:"Sabrina Carpenter",ig:"sabrinacarpenter",tt:"sabrinacarpenter",c:"#E8456B",a:"SC"},{r:2,n:"Kendrick Lamar",ig:"kendricklamar",tt:"kendricklamar",c:"#4A90D9",a:"KL"},{r:3,n:"Billie Eilish",ig:"billieeilish",tt:"billieeilish",c:"#2ECC71",a:"BE"},{r:4,n:"Tyler, The Creator",ig:"feliciathegoat",tt:"tylerthecreator",c:"#F39C12",a:"TC"},{r:5,n:"SZA",ig:"sza",tt:"sza",c:"#9B59B6",a:"SZ"},{r:6,n:"Post Malone",ig:"postmalone",tt:"postmalone",c:"#E67E22",a:"PM"},{r:7,n:"Doja Cat",ig:"dojacat",tt:"dojacat",c:"#FF69B4",a:"DC"},{r:8,n:"Bruno Mars",ig:"brunomars",tt:"brunomars",c:"#C0392B",a:"BM"},{r:9,n:"Chappell Roan",ig:"chappellroan",tt:"chappellroan",c:"#E74C8B",a:"CR"},{r:10,n:"Lady Gaga",ig:"ladygaga",tt:"ladygaga",c:"#8E44AD",a:"LG"},{r:11,n:"Tate McRae",ig:"tatemcrae",tt:"tatemcrae",c:"#1ABC9C",a:"TM"},{r:12,n:"Megan Thee Stallion",ig:"theestallion",tt:"megantheestallion",c:"#E74C3C",a:"MS"},{r:13,n:"Travis Scott",ig:"travisscott",tt:"travisscott",c:"#34495E",a:"TS"},{r:14,n:"Bad Bunny",ig:"badbunnypr",tt:"badbunny",c:"#F1C40F",a:"BB"},{r:15,n:"Ariana Grande",ig:"arianagrande",tt:"arianagrande",c:"#D4A5A5",a:"AG"},{r:16,n:"Rosalia",ig:"rosalia.vt",tt:"rosalia",c:"#FF4500",a:"RO"},{r:17,n:"Jack Harlow",ig:"jackharlow",tt:"jackharlow",c:"#5DADE2",a:"JH"},{r:18,n:"Dua Lipa",ig:"dualipa",tt:"dualipa",c:"#A569BD",a:"DL"},{r:19,n:"Lil Baby",ig:"lilbaby",tt:"lilbaby",c:"#45B7D1",a:"LB"},{r:20,n:"Ice Spice",ig:"icespice",tt:"icespice",c:"#FF6347",a:"IS"},{r:21,n:"Morgan Wallen",ig:"morganwallen",tt:"morganwallen",c:"#8B7355",a:"MW"},{r:22,n:"21 Savage",ig:"21savage",tt:"21savage",c:"#2C3E50",a:"21"},{r:23,n:"Gunna",ig:"gunna",tt:"gunna",c:"#27AE60",a:"GU"},{r:24,n:"Olivia Rodrigo",ig:"oliviarodrigo",tt:"oliviarodrigo",c:"#C39BD3",a:"OR"},{r:25,n:"Future",ig:"future",tt:"future",c:"#17202A",a:"FU"}];
const EM={"Reel":"\u{1F3AC}","Carousel":"\u{1F4F8}","Photo":"\u{1F4F7}","Sidecar":"\u{1F4F8}","Image":"\u{1F4F7}","Video":"\u{1F3A5}","Duet":"\u{1F46F}","LIVE":"\u{1F534}","Story":"\u23F3"};
let S={sel:A[0],days:30,sort:"views",filt:"all",ptab:"all",showAll:false,q:"",stg:false,exp:null,tok:"",busy:false,data:{},toast:null};
try{const v=JSON.parse(localStorage.getItem("cspy3")||"{}");if(v.tok)S.tok=v.tok;if(v.data)S.data=v.data;}catch(e){}
function save(){try{localStorage.setItem("cspy3",JSON.stringify({tok:S.tok,data:S.data}));}catch(e){}}
function fmt(n){return n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(1)+"K":""+n}
function fmtD(d){try{return new Date(d+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch(e){return d}}
function rng(s){return()=>{s=(s*16807)%2147483647;return(s-1)/2147483646}}
let _tt;function toast(m,d){S.toast=m;render();clearTimeout(_tt);_tt=setTimeout(()=>{S.toast=null;render()},d||15000)}
function mock(ar,pl,dy){const r=rng(ar.r*1e3+dy+(pl==="tiktok"?5e3:0)),o=[],ty=pl==="instagram"?["Reel","Carousel","Photo"]:["Video","Duet"],cp=["New video out now \u{1F525}","Thank you for 1B streams \u{1F495}","Studio vibes \u{1F3B5}","Tour soon \u{1F440}","BTS from shoot \u{1F3AC}",ar.n+" killed this \u{1F60D}","Fan edit \u{1F3A8}",ar.n+" supremacy \u{1F451}"],n=Math.floor(r()*(dy/1.2))+Math.ceil(dy/3),sx=["_daily","_edits","_fanclub",".updates","_clips"];for(let i=0;i<n;i++){const of_=r()>.45,d=new Date(Date.now()-Math.floor(r()*dy)*864e5),vw=of_?Math.floor(r()*15e6)+5e5:Math.floor(r()*3e6)+5e4,lk=Math.floor(vw*(.03+r()*.12)),sv=Math.floor(lk*(.05+r()*.2)),sh=Math.floor(lk*(.02+r()*.1)),cm=Math.floor(lk*(.01+r()*.05)),eg=((lk+sv+sh+cm)/vw*100).toFixed(2),bs=ar.n.toLowerCase().replace(/[^a-z]/g,"").slice(0,8),pt=ty[Math.floor(r()*ty.length)];o.push({id:pl+"-"+ar.r+"-"+i,pl,tp:of_?"official":"fan",hn:of_?"@"+(pl==="instagram"?ar.ig:ar.tt):"@"+bs+sx[Math.floor(r()*sx.length)],pt,cp:cp[Math.floor(r()*cp.length)],dt:d.toISOString().split("T")[0],url:"#",vw,lk,sv,sh,cm,eg:+eg,thu:null,vid:null,isV:["Reel","Video","Duet","LIVE"].includes(pt)})}return o}
async function callAPI(actorId,input){const res=await fetch("/api/scrape",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:S.tok,actorId,input})});const d=await res.json();if(!res.ok||d.error)throw new Error(d.error||"Error "+res.status);return d.items||d;}
async function scrape(ar){
const cached=S.data[ar.n];if(cached&&cached.at){const age=(Date.now()-new Date(cached.at).getTime())/36e5;if(age<6){const skip=confirm("Data is "+Math.round(age)+"h old (fresh). Scrape again anyway?");if(!skip)return;}}
S.busy=true;render();const R={instagram:[],tiktok:[],at:new Date().toISOString()};const hashtag=ar.n.replace(/[^a-zA-Z]/g,"").toLowerCase();function mapIG(p,tp,hn){const thu=p.displayUrl||p.thumbnailUrl||p.imageUrl||null;const vid=p.videoUrl||null;return{id:p.id||p.shortCode||"ig-"+Math.random(),pl:"instagram",tp,hn,pt:p.type||(vid?"Reel":"Photo"),cp:(p.caption||"").slice(0,300),dt:p.timestamp?new Date(p.timestamp).toISOString().split("T")[0]:"",url:p.url||"https://www.instagram.com/p/"+(p.shortCode||""),vw:p.videoViewCount||p.playCount||p.videoPlayCount||0,lk:p.likesCount||p.likes||0,sv:0,sh:0,cm:p.commentsCount||p.comments||0,eg:p.videoViewCount?+((p.likesCount+p.commentsCount||0)/p.videoViewCount*100).toFixed(2):0,thu,vid,isV:!!(vid||p.type==="Video"||p.type==="Reel")};}function mapTT(p,tp,hn){const thu=p.videoMeta?.coverUrl||p.covers?.default||p.cover||p.originCover||null;const vid=p.videoUrl||p.videoMeta?.downloadAddr||null;return{id:p.id||p.videoId||"tt-"+Math.random(),pl:"tiktok",tp,hn,pt:p.duetInfo?"Duet":"Video",cp:(p.text||p.desc||"").slice(0,300),dt:p.createTime?new Date(p.createTime*1e3).toISOString().split("T")[0]:"",url:p.webVideoUrl||"",vw:p.playCount||0,lk:p.diggCount||0,sv:p.collectCount||0,sh:p.shareCount||0,cm:p.commentCount||0,eg:p.playCount?+((p.diggCount+p.shareCount+p.commentCount||0)/p.playCount*100).toFixed(2):0,thu,vid,isV:true};}
toast("\u{1F50D} Scraping "+ar.n+"...",120000);const[igR,ttR]=await Promise.allSettled([callAPI("apify/instagram-profile-scraper",{usernames:[ar.ig],resultsLimit:15,resultsType:"posts"}).then(raw=>{let posts=[];raw.forEach(p=>{if(p.latestPosts&&Array.isArray(p.latestPosts))posts=posts.concat(p.latestPosts);});if(posts.length===0&&raw.length>0&&(raw[0].shortCode||raw[0].displayUrl))posts=raw;return posts.map(p=>mapIG(p,"official","@"+ar.ig));}),callAPI("clockworks/free-tiktok-scraper",{profiles:[ar.tt],resultsPerPage:15,shouldDownloadVideos:true,shouldDownloadCovers:true}).then(raw=>raw.map(p=>mapTT(p,"official","@"+ar.tt)))]);
if(igR.status==="fulfilled"){R.instagram=igR.value;toast("\u2713 IG: "+igR.value.length,8000);}else toast("\u26A0 IG: "+igR.reason?.message,8000);if(ttR.status==="fulfilled"){R.tiktok=ttR.value;toast("\u2713 TT: "+ttR.value.length,8000);}else toast("\u26A0 TT: "+ttR.reason?.message,8000);S.data[ar.n]=R;save();render();
toast("\u{1F50D} Fan content #"+hashtag+"...",120000);const[igF,ttF]=await Promise.allSettled([callAPI("apify/instagram-hashtag-scraper",{hashtags:[hashtag],resultsLimit:10,resultsType:"posts"}).then(raw=>raw.map(p=>mapIG(p,"fan","@"+(p.ownerUsername||"fan")))),callAPI("clockworks/tiktok-hashtag-scraper",{hashtags:[hashtag],resultsPerPage:10}).then(raw=>raw.map(p=>mapTT(p,"fan","@"+(p.authorMeta?.name||p.author?.uniqueId||"fan"))))]);
if(igF.status==="fulfilled"){R.instagram=R.instagram.concat(igF.value);}if(ttF.status==="fulfilled"){R.tiktok=R.tiktok.concat(ttF.value);}S.data[ar.n]=R;S.busy=false;save();toast("\u2713 Done! "+(R.instagram.length+R.tiktok.length)+" posts",15000);render();}
function getP(ar,pl,dy){const lv=S.data[ar.n];let p;if(lv&&(lv.instagram?.length||lv.tiktok?.length)){p=(lv[pl]||[]).map(x=>({...x,eg:+x.eg||0}));}else{p=mock(ar,pl,dy);}const cut=new Date(Date.now()-dy*864e5).toISOString().split("T")[0];p=p.filter(x=>!x.dt||x.dt>=cut);if(S.filt==="official")p=p.filter(x=>x.tp==="official");if(S.filt==="fan")p=p.filter(x=>x.tp==="fan");p.sort((a,b)=>S.sort==="views"?b.vw-a.vw:S.sort==="likes"?b.lk-a.lk:S.sort==="engagement"?b.eg-a.eg:S.sort==="shares"?b.sh-a.sh:new Date(b.dt)-new Date(a.dt));return p;}
function render(){const ar=S.sel,ht=!!S.tok,hl=!!S.data[ar.n];const vis=(S.showAll?A:A.slice(0,10)).filter(x=>x.n.toLowerCase().includes(S.q.toLowerCase()));const ig=getP(ar,"instagram",S.days),tt=getP(ar,"tiktok",S.days);let all=S.ptab==="all"?[...ig,...tt]:S.ptab==="instagram"?ig:tt;all.sort((a,b)=>S.sort==="views"?b.vw-a.vw:S.sort==="likes"?b.lk-a.lk:S.sort==="engagement"?b.eg-a.eg:S.sort==="shares"?b.sh-a.sh:new Date(b.dt)-new Date(a.dt));const tv=all.reduce((s,p)=>s+p.vw,0),tl=all.reduce((s,p)=>s+p.lk,0),ts=all.reduce((s,p)=>s+p.sh,0),ae=all.length?(all.reduce((s,p)=>s+p.eg,0)/all.length).toFixed(1):"0";
function skel(){return'<div class="skel"><div class="skel-img"></div><div class="skel-bd"><div class="skel-ln w60"></div><div class="skel-ln w80"></div><div class="skel-row"><div class="skel-ln"></div><div class="skel-ln"></div><div class="skel-ln"></div></div></div></div>'}
const skelGrid=S.busy&&all.length===0?Array(6).fill(0).map(()=>skel()).join(""):"";
const cacheAge=hl?((Date.now()-new Date(S.data[ar.n].at).getTime())/36e5):null;
const cacheStr=cacheAge!==null?(cacheAge<1?"<span class='fresh'>\u25CF</span> "+Math.round(cacheAge*60)+"m ago":cacheAge<6?"<span class='fresh'>\u25CF</span> "+Math.round(cacheAge)+"h ago":"<span class='stale'>\u25CF</span> "+Math.round(cacheAge)+"h ago"):"";
function card(p,i){const isI=p.pl==="instagram",ec=p.eg>8?"var(--green)":p.eg>4?"var(--amber)":"var(--t3)",eb=p.eg>8?"rgba(0,80,40,.7)":p.eg>4?"rgba(80,60,0,.7)":"rgba(0,0,0,.5)",em=EM[p.pt]||"\u{1F4F1}";let th;if(p.thu){th='<img src="'+p.thu+'" loading="lazy" onload="this.classList.add(\'loaded\')" onerror="this.style.display=\'none\';this.nextElementSibling.style.display=\'flex\'"><div class="card-ph" style="display:none;background:linear-gradient(145deg,'+ar.c+'22,'+ar.c+'08,var(--bg4))"><div class="e">'+em+'</div><div class="c">'+(p.cp||"Content")+'</div></div>';if(p.vid)th+='<video src="'+p.vid+'" muted loop playsinline preload="none" data-hv></video>';}else th='<div class="card-ph" style="background:linear-gradient(145deg,'+ar.c+'22,'+ar.c+'08,var(--bg4))"><div class="e">'+em+'</div><div class="c">'+(p.cp||"Content post")+'</div></div>';return'<div class="card" data-id="'+p.id+'" style="animation:fadeIn .3s var(--ease) '+Math.min(i*0.03,.3)+'s both"><div class="card-img">'+th+(p.isV?'<div class="play"></div>':'')+'<div class="badges"><span class="'+(p.tp==="official"?"b-off":"b-fan")+'">'+(p.tp==="official"?"OFFICIAL":"FAN")+'</span><span class="'+(isI?"b-ig":"b-tt")+'">'+(isI?"IG":"TT")+'</span></div><div class="card-type">'+p.pt+'</div><div class="card-eng" style="background:'+eb+';color:'+ec+'">'+p.eg+'%</div></div><div class="card-bd"><div class="card-hd"><span class="card-hn">'+p.hn+'</span><span class="card-dt">'+fmtD(p.dt)+'</span></div><div class="card-cp">'+p.cp+'</div><div class="card-st"><span>\u25B6 '+fmt(p.vw)+'</span><span>\u2665 '+fmt(p.lk)+'</span><span>\u2197 '+fmt(p.sh)+'</span><span>\u{1F4AC} '+fmt(p.cm)+'</span></div></div></div>'}
let modH="";if(S.exp){const p=S.exp,isI=p.pl==="instagram",em=EM[p.pt]||"\u{1F4F1}";let med;if(p.vid)med='<video id="mvid" src="'+p.vid+'" controls autoplay loop playsinline poster="'+(p.thu||"")+'" style="width:100%;max-height:480px;object-fit:contain;background:#000"></video><button class="md-mute" id="mbtn">\u{1F507} Unmute</button>';else if(p.thu&&p.isV)med='<div style="position:relative"><img src="'+p.thu+'" style="width:100%;opacity:.65"><div style="position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;background:rgba(0,0,0,.2)"><div style="font-size:11px;color:var(--t2);font-family:var(--mono);margin-bottom:10px">Video not available for direct playback</div><a href="'+(p.url||"#")+'" target="_blank" style="padding:10px 22px;background:'+(isI?"var(--ig)":"var(--tt)")+';color:'+(isI?"#fff":"#000")+';border-radius:var(--r);font-size:12px;font-weight:600;text-decoration:none">\u25B6 Watch on '+(isI?"Instagram":"TikTok")+'</a></div></div>';else if(p.thu)med='<img src="'+p.thu+'">';else med='<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;min-height:200px;background:linear-gradient(145deg,'+ar.c+'18,var(--bg3))"><div style="font-size:40px;margin-bottom:10px">'+em+'</div><div style="font-size:12px;color:var(--t3);text-align:center;line-height:1.6">'+p.cp+'</div></div>';const notice=p.vid?'<div style="font-size:9px;color:var(--t3);font-family:var(--mono);margin-bottom:12px;display:flex;align-items:center;gap:6px"><span style="width:5px;height:5px;border-radius:50%;background:var(--green);display:inline-block;animation:pulse 2s infinite"></span>Playing'+(p.url&&p.url!=="#"?' <span style="color:var(--t4)">\u00B7</span> <a href="'+p.url+'" target="_blank" style="color:'+(isI?"var(--ig)":"var(--tt)")+';text-decoration:none">Open on '+(isI?"Instagram":"TikTok")+' \u2192</a>':'')+'</div>':"";modH='<div class="ov" id="mbg"><div class="md"><div class="md-media">'+med+'<button class="md-x" id="mx">\u2715</button></div><div class="md-body">'+notice+'<div class="md-tags"><span class="md-handle">'+p.hn+'</span><span class="md-tag" style="background:'+(p.tp==="official"?"rgba(255,255,255,.06)":"rgba(255,255,255,.03)")+';color:'+(p.tp==="official"?"var(--t1)":"var(--t2)")+'">'+(p.tp==="official"?"OFFICIAL":"FAN")+'</span><span class="md-tag" style="background:'+(isI?"rgba(225,48,108,.1)":"rgba(37,244,238,.06)")+';color:'+(isI?"var(--ig)":"var(--tt)")+'">'+(isI?"IG":"TT")+' \u00B7 '+p.pt+'</span><span style="font-size:9px;color:var(--t4);font-family:var(--mono);margin-left:auto">'+fmtD(p.dt)+'</span></div><div class="md-cap">'+p.cp+'</div><div class="md-stats"><div class="md-stat"><div class="sv">'+fmt(p.vw)+'</div><div class="sl">Views</div></div><div class="md-stat"><div class="sv">'+fmt(p.lk)+'</div><div class="sl">Likes</div></div><div class="md-stat"><div class="sv">'+fmt(p.sv)+'</div><div class="sl">Saves</div></div><div class="md-stat"><div class="sv">'+fmt(p.sh)+'</div><div class="sl">Shares</div></div><div class="md-stat"><div class="sv">'+fmt(p.cm)+'</div><div class="sl">Comments</div></div><div class="md-stat"><div class="sv" style="color:'+(p.eg>8?"var(--green)":p.eg>4?"var(--amber)":"var(--t2)")+'">'+p.eg+'%</div><div class="sl">Eng Rate</div></div></div>'+(p.url&&p.url!=="#"?'<a href="'+p.url+'" target="_blank" class="md-link">View on '+(isI?"Instagram":"TikTok")+' \u2192</a>':'')+'</div></div></div>'}
let stgH="";if(S.stg){stgH='<div class="ov" id="sbg"><div class="stg"><button class="stg-x" id="sx">\u2715</button><h2>Settings</h2><div class="stg-s" style="border-color:'+(ht?"rgba(0,230,118,.15)":"rgba(255,82,82,.12)")+'"><div class="stg-t">Apify API Token</div><div style="display:flex;align-items:center;gap:6px;margin-bottom:6px"><span style="width:6px;height:6px;border-radius:50%;background:'+(ht?"var(--green)":"#FF5252")+';display:inline-block"></span><span style="font-size:10px;color:var(--t2);font-family:var(--mono)">'+(ht?"Connected":"Not set")+'</span></div><input class="stg-in" id="tinp" type="password" placeholder="Paste your Apify token..." value="'+S.tok+'"><button class="stg-btn" style="background:linear-gradient(135deg,var(--ig),#C13584)" id="tsav">Save Token</button></div><div class="stg-s"><div class="stg-t">Actions</div><button class="stg-btn" style="background:'+(ht?"linear-gradient(135deg,var(--ig),#C13584)":"rgba(255,255,255,.03)")+';opacity:'+(ht?1:.35)+'" id="sscrape" '+(ht?"":"disabled")+'>Scrape '+ar.n+'</button><button class="stg-btn" style="background:rgba(255,255,255,.04)" id="sclear">Clear Data</button></div><div class="stg-s"><div class="stg-t">Setup Guide</div><div class="stg-steps"><div>1. Go to <b>console.apify.com</b></div><div>2. Settings \u2192 Integrations \u2192 Copy token</div><div>3. Paste above \u2192 Save</div><div>4. Close this \u2192 Click Scrape</div><div>5. Wait 1-2 min \u2192 Content loads</div></div></div></div></div>'}
document.getElementById("app").innerHTML='<div class="sidebar"><div class="sb-hd"><div class="sb-logo"><h1>Content Spy</h1><div class="sub">Billboard Hot 100 Tracker</div></div><div class="sb-status"><span class="sb-dot" style="background:'+(hl?"var(--green)":"var(--amber)")+'"></span><span>'+(hl?"Live data":"Demo mode")+'</span></div></div><div class="sb-search"><input placeholder="Search artists..." value="'+S.q+'" id="qinp"></div><div class="sb-list">'+vis.map(x=>'<div class="sb-item '+(S.sel.r===x.r?"on":"")+'" data-r="'+x.r+'"><div class="sb-r">'+x.r+'</div><div class="sb-av" style="background:linear-gradient(135deg,'+x.c+'bb,'+x.c+'44)">'+x.a+'</div><div class="sb-n">'+x.n+'</div></div>').join("")+'<div class="sb-more" id="tog">'+(S.showAll?"Show less \u2191":"All 25 artists \u2193")+'</div></div><div class="sb-ft"><button id="obtn">\u2699\uFE0E Settings</button></div></div><div class="main"><div class="top"><div class="top-l"><div class="top-av" style="background:linear-gradient(135deg,'+ar.c+'cc,'+ar.c+'44)">'+ar.a+'</div><div><div class="top-name">'+ar.n+'</div><div class="top-sub">#'+ar.r+' on Billboard \u00B7 @'+ar.ig+' \u00B7 @'+ar.tt+'</div></div></div><div class="top-r"><button class="chip '+(S.busy?"busy-chip":"")+'" id="scr" style="'+(ht?"border-color:"+ar.c+"33;color:"+ar.c:"opacity:.35")+'" '+(ht?"":"disabled")+'>'+(S.busy?"\u23F3 Scraping...":"\u21BB Scrape")+'</button><button class="chip" id="csv">\u2193 Export</button><div class="chip-grp">'+[{l:"7D",v:7},{l:"14D",v:14},{l:"30D",v:30}].map(t=>'<button data-d="'+t.v+'" class="'+(S.days===t.v?"on":"")+'"'+(S.days===t.v?' style="color:'+ar.c+'"':'')+'>'+t.l+'</button>').join("")+'</div><select class="sel" id="srt">'+["views","likes","engagement","shares","date"].map(s=>'<option value="'+s+'" '+(S.sort===s?"selected":"")+'>'+s[0].toUpperCase()+s.slice(1)+'</option>').join("")+'</select><div class="chip-grp">'+[{l:"All",v:"all"},{l:"Official",v:"official"},{l:"Fan",v:"fan"}].map(f=>'<button data-f="'+f.v+'" class="'+(S.filt===f.v?"on":"")+'">'+f.l+'</button>').join("")+'</div></div></div><div class="cnt"><div class="tabs"><div class="tab '+(S.ptab==="all"?"on":"")+'" data-p="all">All<span class="num">'+(ig.length+tt.length)+'</span></div><div class="tab '+(S.ptab==="instagram"?"on":"")+'" data-p="instagram"><div class="dot" style="background:var(--ig)"></div>Instagram<span class="num">'+ig.length+'</span></div><div class="tab '+(S.ptab==="tiktok"?"on":"")+'" data-p="tiktok"><div class="dot" style="background:var(--tt)"></div>TikTok<span class="num">'+tt.length+'</span></div></div><div class="strip"><div class="strip-item"><span class="v">'+fmt(tv)+'</span><span class="l">Views</span></div><div class="strip-item"><span class="v">'+fmt(tl)+'</span><span class="l">Likes</span></div><div class="strip-item"><span class="v">'+fmt(ts)+'</span><span class="l">Shares</span></div><div class="strip-item"><span class="v" style="color:'+(+ae>7?"var(--green)":+ae>4?"var(--amber)":"var(--t2)")+'">'+ae+'%</span><span class="l">Eng Rate</span></div><div class="strip-item"><span class="v">'+all.length+'</span><span class="l">Posts</span></div></div><div class="grid">'+skelGrid+all.slice(0,30).map((p,i)=>card(p,i)).join("")+'</div>'+(all.length>30?'<div class="ft">Showing 30 of '+all.length+'</div>':'')+(all.length===0&&!S.busy?'<div class="empty">'+(ht?"No posts in this range. Try 30D or Scrape.":"Add your Apify token in Settings to load real content.")+'</div>':'')+'<div class="ft">'+(hl?'<span class="cache-tag">'+cacheStr+' Last scraped '+new Date(S.data[ar.n].at).toLocaleString()+'</span>':"Demo data \u00B7 Connect Apify for real content")+'</div></div></div>'+modH+stgH+(S.toast?'<div class="toast">'+S.toast+'</div>':'');
document.querySelectorAll(".sb-item").forEach(el=>el.onclick=()=>{S.sel=A.find(x=>x.r===+el.dataset.r)||A[0];S.exp=null;render()});const qi=document.getElementById("qinp");if(qi){qi.oninput=e=>{S.q=e.target.value;render();document.getElementById("qinp").focus()}}const tg=document.getElementById("tog");if(tg)tg.onclick=()=>{S.showAll=!S.showAll;render()};document.querySelectorAll("[data-d]").forEach(b=>b.onclick=()=>{S.days=+b.dataset.d;render()});const sr=document.getElementById("srt");if(sr)sr.onchange=e=>{S.sort=e.target.value;render()};document.querySelectorAll("[data-f]").forEach(b=>b.onclick=()=>{S.filt=b.dataset.f;render()});document.querySelectorAll("[data-p]").forEach(b=>b.onclick=()=>{S.ptab=b.dataset.p;render()});const sc=document.getElementById("scr");if(sc)sc.onclick=()=>{if(!S.busy&&ht)scrape(S.sel)};const cv=document.getElementById("csv");if(cv)cv.onclick=()=>{const ap=[...getP(S.sel,"instagram",S.days),...getP(S.sel,"tiktok",S.days)];const h="Platform,Type,Handle,PostType,Date,Views,Likes,Saves,Shares,Comments,EngRate,Caption,URL\n";const r=ap.map(p=>[p.pl,p.tp,p.hn,p.pt,p.dt,p.vw,p.lk,p.sv,p.sh,p.cm,p.eg,'"'+(p.cp||"").replace(/"/g,'""')+'"',p.url].join(",")).join("\n");const bl=new Blob([h+r],{type:"text/csv"});const u=URL.createObjectURL(bl);const a=document.createElement("a");a.href=u;a.download=S.sel.n.replace(/\s+/g,"_")+".csv";a.click()};
const ob=document.getElementById("obtn");if(ob)ob.onclick=()=>{S.stg=true;render()};const sx=document.getElementById("sx");if(sx)sx.onclick=()=>{S.stg=false;render()};const sbg=document.getElementById("sbg");if(sbg)sbg.onclick=e=>{if(e.target===sbg){S.stg=false;render()}};const ts2=document.getElementById("tsav");if(ts2)ts2.onclick=()=>{S.tok=document.getElementById("tinp").value.trim();save();toast("\u2713 Token saved");render()};const ss=document.getElementById("sscrape");if(ss)ss.onclick=()=>{S.stg=false;if(!S.busy)scrape(S.sel)};const scl=document.getElementById("sclear");if(scl)scl.onclick=()=>{S.data={};save();toast("Data cleared");render()};
document.querySelectorAll(".card").forEach(el=>{el.onclick=()=>{const p=all.find(x=>x.id===el.dataset.id);if(p){S.exp=p;render()}};const v=el.querySelector("video[data-hv]");if(v){el.onmouseenter=()=>{v.currentTime=0;v.play().catch(()=>{})};el.onmouseleave=()=>{v.pause();v.currentTime=0}}});const mbg=document.getElementById("mbg");if(mbg)mbg.onclick=e=>{if(e.target===mbg){S.exp=null;render()}};const mx=document.getElementById("mx");if(mx)mx.onclick=()=>{S.exp=null;render()};const mb=document.getElementById("mbtn"),mv=document.getElementById("mvid");if(mb&&mv)mb.onclick=e=>{e.stopPropagation();mv.muted=!mv.muted;mb.textContent=mv.muted?"\u{1F507} Unmute":"\u{1F50A} Mute"};}
render();
</script>
</body>
</html>
